<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>Radar Chart Log Scale</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      .toggle-container {
        display: flex;
        align-items: center;
        font-size: 16px;
        margin-bottom: 20px;
      }

      .toggle-container input[type="checkbox"] {
        appearance: none;
        -webkit-appearance: none;
        height: 25px;
        width: 45px;
        display: inline-block;
        position: relative;
        border-radius: 15px;
        background-color: #ccc;
        cursor: pointer;
        margin-right: 10px;
        vertical-align: middle;
        transition: background-color 0.2s;
      }

      .toggle-container input[type="checkbox"]:checked {
        background-color: #4caf50;
      }

      .toggle-container input[type="checkbox"]:before {
        content: "";
        position: absolute;
        top: 2px;
        left: 2px;
        bottom: 2px;
        width: 21px;
        background-color: white;
        border-radius: 50%;
        transition: left 0.2s;
      }

      .toggle-container input[type="checkbox"]:checked:before {
        left: 22px;
      }

      #myRadarChart {
        max-width: 100%;
        height: auto;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
      }
    </style>
  </head>
  <body>
    <label class="toggle-container">
      <input type="checkbox" id="scaleToggle" />
      <span>対数スケールMode</span>
    </label>
    <canvas id="myRadarChart" width="300" height="300"></canvas>

    <script>
      const ctx = document.getElementById("myRadarChart").getContext("2d");
      const originalData = [
        [10, 10, 10, 10, 10, 10, 10],
        [60, 60, 60, 60, 60, 60, 60],
        [80, 80, 80, 80, 80, 80, 80],
        [100, 100, 100, 100, 100, 100, 100],
      ];

      const logTransform = (data) => {
        return data.map((value) => Math.log10(value));
      };

      const updateDatasets = (logScale) => {
        return originalData.map((dataset) => (logScale ? logTransform(dataset) : dataset));
      };

      const initializeChart = (logScale = false) => {
        var updatedData = updateDatasets(logScale);
        if (window.myRadarChart && typeof window.myRadarChart.destroy === "function") {
          window.myRadarChart.destroy();
        }
        window.myRadarChart = new Chart(ctx, {
          type: "radar",
          data: {
            labels: [
              "基礎としてのマインド・スタンス",
              "デザイン思考／アジャイルな働き方",
              "DXの背景への理解",
              "データ理解",
              "デジタル技術の理解",
              "データ・技術の活用事例・利用方法",
              "データ・技術の利活用における留意点",
            ],
            datasets: [
              {
                label: "DXリテラシー",
                data: updatedData[2],
                fill: true,
                backgroundColor: "rgba(54, 162, 235, 0.2)",
                borderColor: "rgb(54, 162, 235)",
              },
              {
                label: "目標値",
                data: updatedData[1],
                fill: false,
                backgroundColor: "rgba(255, 99, 132, 0.2)",
                borderColor: "rgb(255, 99, 132)",
              },
              // {
              //   label: "枠線",
              //   data: updatedData[2],
              //   fill: false,
              //   backgroundColor: "lightgray",
              //   borderColor: "lightgray",
              // },
            ],
          },
          options: {
            scales: {
              r: {
                angleLines: {
                  display: true,
                  //   color: "black",
                },
                grid: {
                  display: false,
                  color: "rgba(0, 0, 0, 0.1)",
                },
                ticks: {
                  display: true,
                  stepSize: logScale ? Math.log10(10) : 20,
                },
                suggestedMin: 0,
                suggestedMax: logScale ? Math.log10(100) : 100,
              },
            },
          },
        });
      };

      document.getElementById("scaleToggle").addEventListener("change", function () {
        initializeChart(this.checked);
      });

      initializeChart();
    </script>
  </body>
</html>
